<?php
session_start();

?>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="WebpageStyle.css">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
              rel="stylesheet"
              integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
              crossorigin="anonymous">
        <title>Successful Login</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <!-- Slick Nav-->
        <link rel="stylesheet" href="css/slicknav.css">
        <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
        <script src="js/jquery.slicknav.min.js"></script>
        <script type="text/javascript">
            $(document).ready(function (){
                $('#nav_menu').slicknav({prependTo: "#mobile_menu"});
            });
        </script>




    </head>
    <body class="body Account">

    <nav id="mobile_menu"></nav>
    <nav class="container" id="nav_menu">
        <ul>
            <li><a href = "leaderboards.php"> Leaderboards </a></li>
            <li><a href = "matchmaking.php"> MatchMaking </a></li>
            <li><a href = "#"> Store </a></li>
            <li><a href = "chat.php"> Chat </a></li>
            <li><a href="#"> Profile </a>
                <ul>
                    <li><a href="#">Achievements</a></li>
                    <li><a href="Account.html">Account</a></li>
                    <li><a href="modify-friends.html">Add Friends</a></li>
                </ul>
            </li>
            <li><a href = "exit.php"> Exit </a></li>

        </ul>
        <br>
        <br>
    </nav>

    <!-- Achievements -->

        <div class="ProfileTop">
            <aside class="Stage1">
                <img src="Images/ProfilePage.png" alt="placeholderImage">
            </aside>
            <main>
                <p id = "Welcome">Welcome: <?php echo $_SESSION['login']; ?></p> <br>
            </main>
        </div>

        <div class="ProfileMid">
            <a class="clear full" href = "modify-friends.php"> Add/remove friends</a> <br>
            <aside>
                <p>Friends List:</p> <br>
                <?php
                    ini_set('display_errors',1);
                    ini_set('display_startup_errors', 1);
                    error_reporting(E_ALL ^ E_DEPRECATED);

                    require("testRabbitMQClient.php");

                    $username = $_SESSION['login'];

                    if(isset ($_SESSION['login']) && !empty($_SESSION['login']))
                    {
                        echo nl2br("Session is good\n");
                        $friends = amqpFriendslist($username);
                        echo nl2br("\n\nCurrent Friends: \n");
                        $count = 0;
                        while($count < count($friends))
                        {
                            echo nl2br("\n" . ($count + 1) . ": $friends[$count]");
                            $count ++;
                        }
                    }
                    else
                    {
                        header("Location: index.php");
                    }
                ?>
            </aside>
            <main>
                <p> Achievements:</p> <br>
                <p> <?php 
                        echo $killimage1;
                        $achievement1 = 1;
                        $achievement2 = 5;
                        $achievement3 = 10;
                        $achievement4 = 20;
                        $achievement5 = 1000;
                        $wins = getWins($username);
                        if ($achievement5 <= $wins)
                        {
                           echo $killimage5;
                           echo $killimage4;
                           echo $killimage3;
                           echo $killimage2;
                           echo $killimage1;
                        }
                        else if ($achievement4 < $wins)
                        {
                          echo $killimage4;
                          echo $killimage3;
                          echo $killimage2;
                          echo $killimage1;
                        }
                        else if ($achievement3 < $wins)
                        {
                         echo $killimage3;
                         echo $killimage2;
                         echo $killimage1;
                        }
                        else if ($achievement2 < $wins)
	                {
                         echo $killimage2;
                         echo $killimage1;
                        }
                        else if ($achievement1 < $wins)
                        {
                         echo $killimage2;
                        }

                  ?>
		</p>
                <ul>
                    <li><img id="kill" src="Images/Kills/kill_off.png" alt="kill"> </li>
                    <li><img id="kill2"  src="Images/Kills/kill2_off.png" alt="kill2"></li>
                </ul>
                <ul>
                    <li><img id="kill3" src="Images/Kills/kill3_off.png" alt="kill3"></li>
                    <li><img id="kill4" src="Images/Kills/kill4_off.png" alt="kill4"> </li>

                </ul>
                <ul>
                    <li><img id="kill5"  src="Images/Kills/kill5_off.png" alt="kill5"> </li>
                </ul>
            </main>
        </div>
        <footer>
            <a href = "loggedIn.php"> Back</a> <br>
        </footer>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
        crossorigin="anonymous"></script>
    </body>


    <script type="text/javascript">
        var wins = 30;
        if(wins >= 10){
            let image = document.getElementById("kill").src = "Images/Kills/kill.png";
        }
        if(wins >= 20){
            let image = document.getElementById("kill2").src = "Images/Kills/kill2.png";
        }
        if(wins >= 30){
            let image = document.getElementById("kill3").src = "Images/Kills/kill3.png";
        }
        if(wins >= 40){
            let image = document.getElementById("kill4").src = "Images/Kills/kill4.png";
        }
        if(wins >= 50){
            let image = document.getElementById("kill4").src = "Images/Kills/kill5.png";
        }

    </script>


</html>

<?php
ini_set('display_errors',1);
ini_set('display_startup_errors', 1);
error_reporting(E_ALL ^ E_DEPRECATED);

if(isset ($_SESSION['login']) && !empty($_SESSION['login']))
{
	echo "Session is good.\n";
}
else
{
	header("Location: index.php");
}
?>

